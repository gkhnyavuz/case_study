with
CONTRACT_DETAIL  as 
(
    select * from 
    (
        values
      (1,DATE('2021-12-29'),'NL','SEAT','111-XX-1'),
      (2,DATE('2021-08-28'),'NL','BMW','111-XX-1'),
      (3,DATE('2020-07-27'),'NL','NISSAN','111-XX-1'),
      (4,DATE('2019-06-26'),'NL','SEAT','1-XX-111'),
      (5,DATE('2019-05-25'),'NL','BMW','111-XX-1'),
      (6,DATE('2018-04-25'),'NL','MERCEDES','1-XX-111'),
      (7,DATE('2018-03-25'),'BE','BMW','1-XX-111'),
      (8,DATE('2018-02-25'),'NL','NISSAN','1-XX-111'),
      (9,DATE('2018-01-25'),'NL','BMW','1-XX-111')

        ) as a (IDCONTRACT,CONTRACTSTARTDATE,COUNTRYCODE,VEHICLEBRAND,LICENSEPLATE)
)

SELECT VEHICLEBRAND,MIN(CONTRACTSTARTDATE) AS PLATE_OCCR_DATE 
FROM CONTRACT_DETAIL
WHERE SUBSTR(LICENSEPLATE,4,1)='-'
AND COUNTRYCODE='NL'
GROUP BY VEHICLEBRAND
